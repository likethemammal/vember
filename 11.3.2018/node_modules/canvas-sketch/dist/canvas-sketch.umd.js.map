{"version":3,"file":"canvas-sketch.umd.js","sources":["../node_modules/defined/index.js","../node_modules/object-assign/index.js","../node_modules/right-now/browser.js","../node_modules/is-promise/index.js","../node_modules/is-dom/index.js","../lib/util.js","../node_modules/repeat-string/index.js","../node_modules/deep-equal/lib/keys.js","../node_modules/deep-equal/lib/is_arguments.js","../node_modules/deep-equal/index.js","../node_modules/dateformat/lib/dateformat.js","../node_modules/pad-left/index.js","../lib/save.js","../lib/paper-sizes.js","../lib/distances.js","../lib/core/resizeCanvas.js","../node_modules/get-canvas-context/index.js","../lib/core/createCanvas.js","../lib/core/SketchManager.js","../lib/core/keyboardShortcuts.js","../lib/canvas-sketch.js"],"sourcesContent":["module.exports = function () {\n    for (var i = 0; i < arguments.length; i++) {\n        if (arguments[i] !== undefined) return arguments[i];\n    }\n};\n","/*\nobject-assign\n(c) Sindre Sorhus\n@license MIT\n*/\n\n'use strict';\n/* eslint-disable no-unused-vars */\nvar getOwnPropertySymbols = Object.getOwnPropertySymbols;\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nvar propIsEnumerable = Object.prototype.propertyIsEnumerable;\n\nfunction toObject(val) {\n\tif (val === null || val === undefined) {\n\t\tthrow new TypeError('Object.assign cannot be called with null or undefined');\n\t}\n\n\treturn Object(val);\n}\n\nfunction shouldUseNative() {\n\ttry {\n\t\tif (!Object.assign) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Detect buggy property enumeration order in older V8 versions.\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=4118\n\t\tvar test1 = new String('abc');  // eslint-disable-line no-new-wrappers\n\t\ttest1[5] = 'de';\n\t\tif (Object.getOwnPropertyNames(test1)[0] === '5') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test2 = {};\n\t\tfor (var i = 0; i < 10; i++) {\n\t\t\ttest2['_' + String.fromCharCode(i)] = i;\n\t\t}\n\t\tvar order2 = Object.getOwnPropertyNames(test2).map(function (n) {\n\t\t\treturn test2[n];\n\t\t});\n\t\tif (order2.join('') !== '0123456789') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test3 = {};\n\t\t'abcdefghijklmnopqrst'.split('').forEach(function (letter) {\n\t\t\ttest3[letter] = letter;\n\t\t});\n\t\tif (Object.keys(Object.assign({}, test3)).join('') !==\n\t\t\t\t'abcdefghijklmnopqrst') {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t} catch (err) {\n\t\t// We don't expect any of the above to throw, but better to be safe.\n\t\treturn false;\n\t}\n}\n\nmodule.exports = shouldUseNative() ? Object.assign : function (target, source) {\n\tvar from;\n\tvar to = toObject(target);\n\tvar symbols;\n\n\tfor (var s = 1; s < arguments.length; s++) {\n\t\tfrom = Object(arguments[s]);\n\n\t\tfor (var key in from) {\n\t\t\tif (hasOwnProperty.call(from, key)) {\n\t\t\t\tto[key] = from[key];\n\t\t\t}\n\t\t}\n\n\t\tif (getOwnPropertySymbols) {\n\t\t\tsymbols = getOwnPropertySymbols(from);\n\t\t\tfor (var i = 0; i < symbols.length; i++) {\n\t\t\t\tif (propIsEnumerable.call(from, symbols[i])) {\n\t\t\t\t\tto[symbols[i]] = from[symbols[i]];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn to;\n};\n","module.exports =\n  global.performance &&\n  global.performance.now ? function now() {\n    return performance.now()\n  } : Date.now || function now() {\n    return +new Date\n  }\n","module.exports = isPromise;\n\nfunction isPromise(obj) {\n  return !!obj && (typeof obj === 'object' || typeof obj === 'function') && typeof obj.then === 'function';\n}\n","module.exports = isNode\n\nfunction isNode (val) {\n  return (!val || typeof val !== 'object')\n    ? false\n    : (typeof window === 'object' && typeof window.Node === 'object')\n      ? (val instanceof window.Node)\n      : (typeof val.nodeType === 'number') &&\n        (typeof val.nodeName === 'string')\n}\n","// TODO: We can remove a huge chunk of bundle size by using a smaller\n// utility module for converting units.\nimport isDOM from 'is-dom';\n\nexport function getClientAPI () {\n  return typeof window !== 'undefined' && window['canvas-sketch-cli'];\n}\n\nexport function isBrowser () {\n  return typeof document !== 'undefined';\n}\n\nexport function isWebGLContext (ctx) {\n  return typeof ctx.clear === 'function' && typeof ctx.clearColor === 'function' && typeof ctx.bufferData === 'function';\n}\n\nexport function isCanvas (element) {\n  return isDOM(element) && /canvas/i.test(element.nodeName) && typeof element.getContext === 'function';\n}\n","/*!\n * repeat-string <https://github.com/jonschlinkert/repeat-string>\n *\n * Copyright (c) 2014-2015, Jon Schlinkert.\n * Licensed under the MIT License.\n */\n\n'use strict';\n\n/**\n * Results cache\n */\n\nvar res = '';\nvar cache;\n\n/**\n * Expose `repeat`\n */\n\nmodule.exports = repeat;\n\n/**\n * Repeat the given `string` the specified `number`\n * of times.\n *\n * **Example:**\n *\n * ```js\n * var repeat = require('repeat-string');\n * repeat('A', 5);\n * //=> AAAAA\n * ```\n *\n * @param {String} `string` The string to repeat\n * @param {Number} `number` The number of times to repeat the string\n * @return {String} Repeated string\n * @api public\n */\n\nfunction repeat(str, num) {\n  if (typeof str !== 'string') {\n    throw new TypeError('expected a string');\n  }\n\n  // cover common, quick use cases\n  if (num === 1) return str;\n  if (num === 2) return str + str;\n\n  var max = str.length * num;\n  if (cache !== str || typeof cache === 'undefined') {\n    cache = str;\n    res = '';\n  } else if (res.length >= max) {\n    return res.substr(0, max);\n  }\n\n  while (max > res.length && num > 1) {\n    if (num & 1) {\n      res += str;\n    }\n\n    num >>= 1;\n    str += str;\n  }\n\n  res += str;\n  res = res.substr(0, max);\n  return res;\n}\n","exports = module.exports = typeof Object.keys === 'function'\n  ? Object.keys : shim;\n\nexports.shim = shim;\nfunction shim (obj) {\n  var keys = [];\n  for (var key in obj) keys.push(key);\n  return keys;\n}\n","var supportsArgumentsClass = (function(){\n  return Object.prototype.toString.call(arguments)\n})() == '[object Arguments]';\n\nexports = module.exports = supportsArgumentsClass ? supported : unsupported;\n\nexports.supported = supported;\nfunction supported(object) {\n  return Object.prototype.toString.call(object) == '[object Arguments]';\n};\n\nexports.unsupported = unsupported;\nfunction unsupported(object){\n  return object &&\n    typeof object == 'object' &&\n    typeof object.length == 'number' &&\n    Object.prototype.hasOwnProperty.call(object, 'callee') &&\n    !Object.prototype.propertyIsEnumerable.call(object, 'callee') ||\n    false;\n};\n","var pSlice = Array.prototype.slice;\nvar objectKeys = require('./lib/keys.js');\nvar isArguments = require('./lib/is_arguments.js');\n\nvar deepEqual = module.exports = function (actual, expected, opts) {\n  if (!opts) opts = {};\n  // 7.1. All identical values are equivalent, as determined by ===.\n  if (actual === expected) {\n    return true;\n\n  } else if (actual instanceof Date && expected instanceof Date) {\n    return actual.getTime() === expected.getTime();\n\n  // 7.3. Other pairs that do not both pass typeof value == 'object',\n  // equivalence is determined by ==.\n  } else if (!actual || !expected || typeof actual != 'object' && typeof expected != 'object') {\n    return opts.strict ? actual === expected : actual == expected;\n\n  // 7.4. For all other Object pairs, including Array objects, equivalence is\n  // determined by having the same number of owned properties (as verified\n  // with Object.prototype.hasOwnProperty.call), the same set of keys\n  // (although not necessarily the same order), equivalent values for every\n  // corresponding key, and an identical 'prototype' property. Note: this\n  // accounts for both named and indexed properties on Arrays.\n  } else {\n    return objEquiv(actual, expected, opts);\n  }\n}\n\nfunction isUndefinedOrNull(value) {\n  return value === null || value === undefined;\n}\n\nfunction isBuffer (x) {\n  if (!x || typeof x !== 'object' || typeof x.length !== 'number') return false;\n  if (typeof x.copy !== 'function' || typeof x.slice !== 'function') {\n    return false;\n  }\n  if (x.length > 0 && typeof x[0] !== 'number') return false;\n  return true;\n}\n\nfunction objEquiv(a, b, opts) {\n  var i, key;\n  if (isUndefinedOrNull(a) || isUndefinedOrNull(b))\n    return false;\n  // an identical 'prototype' property.\n  if (a.prototype !== b.prototype) return false;\n  //~~~I've managed to break Object.keys through screwy arguments passing.\n  //   Converting to array solves the problem.\n  if (isArguments(a)) {\n    if (!isArguments(b)) {\n      return false;\n    }\n    a = pSlice.call(a);\n    b = pSlice.call(b);\n    return deepEqual(a, b, opts);\n  }\n  if (isBuffer(a)) {\n    if (!isBuffer(b)) {\n      return false;\n    }\n    if (a.length !== b.length) return false;\n    for (i = 0; i < a.length; i++) {\n      if (a[i] !== b[i]) return false;\n    }\n    return true;\n  }\n  try {\n    var ka = objectKeys(a),\n        kb = objectKeys(b);\n  } catch (e) {//happens when one is a string literal and the other isn't\n    return false;\n  }\n  // having the same number of owned properties (keys incorporates\n  // hasOwnProperty)\n  if (ka.length != kb.length)\n    return false;\n  //the same set of keys (although not necessarily the same order),\n  ka.sort();\n  kb.sort();\n  //~~~cheap key test\n  for (i = ka.length - 1; i >= 0; i--) {\n    if (ka[i] != kb[i])\n      return false;\n  }\n  //equivalent values for every corresponding key, and\n  //~~~possibly expensive deep test\n  for (i = ka.length - 1; i >= 0; i--) {\n    key = ka[i];\n    if (!deepEqual(a[key], b[key], opts)) return false;\n  }\n  return typeof a === typeof b;\n}\n","/*\n * Date Format 1.2.3\n * (c) 2007-2009 Steven Levithan <stevenlevithan.com>\n * MIT license\n *\n * Includes enhancements by Scott Trenda <scott.trenda.net>\n * and Kris Kowal <cixar.com/~kris.kowal/>\n *\n * Accepts a date, a mask, or a date and a mask.\n * Returns a formatted version of the given date.\n * The date defaults to the current date/time.\n * The mask defaults to dateFormat.masks.default.\n */\n\n(function(global) {\n  'use strict';\n\n  var dateFormat = (function() {\n      var token = /d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\\1?|[LloSZWN]|\"[^\"]*\"|'[^']*'/g;\n      var timezone = /\\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\\d{4})?)\\b/g;\n      var timezoneClip = /[^-+\\dA-Z]/g;\n  \n      // Regexes and supporting functions are cached through closure\n      return function (date, mask, utc, gmt) {\n  \n        // You can't provide utc if you skip other args (use the 'UTC:' mask prefix)\n        if (arguments.length === 1 && kindOf(date) === 'string' && !/\\d/.test(date)) {\n          mask = date;\n          date = undefined;\n        }\n  \n        date = date || new Date;\n  \n        if(!(date instanceof Date)) {\n          date = new Date(date);\n        }\n  \n        if (isNaN(date)) {\n          throw TypeError('Invalid date');\n        }\n  \n        mask = String(dateFormat.masks[mask] || mask || dateFormat.masks['default']);\n  \n        // Allow setting the utc/gmt argument via the mask\n        var maskSlice = mask.slice(0, 4);\n        if (maskSlice === 'UTC:' || maskSlice === 'GMT:') {\n          mask = mask.slice(4);\n          utc = true;\n          if (maskSlice === 'GMT:') {\n            gmt = true;\n          }\n        }\n  \n        var _ = utc ? 'getUTC' : 'get';\n        var d = date[_ + 'Date']();\n        var D = date[_ + 'Day']();\n        var m = date[_ + 'Month']();\n        var y = date[_ + 'FullYear']();\n        var H = date[_ + 'Hours']();\n        var M = date[_ + 'Minutes']();\n        var s = date[_ + 'Seconds']();\n        var L = date[_ + 'Milliseconds']();\n        var o = utc ? 0 : date.getTimezoneOffset();\n        var W = getWeek(date);\n        var N = getDayOfWeek(date);\n        var flags = {\n          d:    d,\n          dd:   pad(d),\n          ddd:  dateFormat.i18n.dayNames[D],\n          dddd: dateFormat.i18n.dayNames[D + 7],\n          m:    m + 1,\n          mm:   pad(m + 1),\n          mmm:  dateFormat.i18n.monthNames[m],\n          mmmm: dateFormat.i18n.monthNames[m + 12],\n          yy:   String(y).slice(2),\n          yyyy: y,\n          h:    H % 12 || 12,\n          hh:   pad(H % 12 || 12),\n          H:    H,\n          HH:   pad(H),\n          M:    M,\n          MM:   pad(M),\n          s:    s,\n          ss:   pad(s),\n          l:    pad(L, 3),\n          L:    pad(Math.round(L / 10)),\n          t:    H < 12 ? dateFormat.i18n.timeNames[0] : dateFormat.i18n.timeNames[1],\n          tt:   H < 12 ? dateFormat.i18n.timeNames[2] : dateFormat.i18n.timeNames[3],\n          T:    H < 12 ? dateFormat.i18n.timeNames[4] : dateFormat.i18n.timeNames[5],\n          TT:   H < 12 ? dateFormat.i18n.timeNames[6] : dateFormat.i18n.timeNames[7],\n          Z:    gmt ? 'GMT' : utc ? 'UTC' : (String(date).match(timezone) || ['']).pop().replace(timezoneClip, ''),\n          o:    (o > 0 ? '-' : '+') + pad(Math.floor(Math.abs(o) / 60) * 100 + Math.abs(o) % 60, 4),\n          S:    ['th', 'st', 'nd', 'rd'][d % 10 > 3 ? 0 : (d % 100 - d % 10 != 10) * d % 10],\n          W:    W,\n          N:    N\n        };\n  \n        return mask.replace(token, function (match) {\n          if (match in flags) {\n            return flags[match];\n          }\n          return match.slice(1, match.length - 1);\n        });\n      };\n    })();\n\n  dateFormat.masks = {\n    'default':               'ddd mmm dd yyyy HH:MM:ss',\n    'shortDate':             'm/d/yy',\n    'mediumDate':            'mmm d, yyyy',\n    'longDate':              'mmmm d, yyyy',\n    'fullDate':              'dddd, mmmm d, yyyy',\n    'shortTime':             'h:MM TT',\n    'mediumTime':            'h:MM:ss TT',\n    'longTime':              'h:MM:ss TT Z',\n    'isoDate':               'yyyy-mm-dd',\n    'isoTime':               'HH:MM:ss',\n    'isoDateTime':           'yyyy-mm-dd\\'T\\'HH:MM:sso',\n    'isoUtcDateTime':        'UTC:yyyy-mm-dd\\'T\\'HH:MM:ss\\'Z\\'',\n    'expiresHeaderFormat':   'ddd, dd mmm yyyy HH:MM:ss Z'\n  };\n\n  // Internationalization strings\n  dateFormat.i18n = {\n    dayNames: [\n      'Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat',\n      'Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'\n    ],\n    monthNames: [\n      'Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec',\n      'January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'\n    ],\n    timeNames: [\n      'a', 'p', 'am', 'pm', 'A', 'P', 'AM', 'PM'\n    ]\n  };\n\nfunction pad(val, len) {\n  val = String(val);\n  len = len || 2;\n  while (val.length < len) {\n    val = '0' + val;\n  }\n  return val;\n}\n\n/**\n * Get the ISO 8601 week number\n * Based on comments from\n * http://techblog.procurios.nl/k/n618/news/view/33796/14863/Calculate-ISO-8601-week-and-year-in-javascript.html\n *\n * @param  {Object} `date`\n * @return {Number}\n */\nfunction getWeek(date) {\n  // Remove time components of date\n  var targetThursday = new Date(date.getFullYear(), date.getMonth(), date.getDate());\n\n  // Change date to Thursday same week\n  targetThursday.setDate(targetThursday.getDate() - ((targetThursday.getDay() + 6) % 7) + 3);\n\n  // Take January 4th as it is always in week 1 (see ISO 8601)\n  var firstThursday = new Date(targetThursday.getFullYear(), 0, 4);\n\n  // Change date to Thursday same week\n  firstThursday.setDate(firstThursday.getDate() - ((firstThursday.getDay() + 6) % 7) + 3);\n\n  // Check if daylight-saving-time-switch occurred and correct for it\n  var ds = targetThursday.getTimezoneOffset() - firstThursday.getTimezoneOffset();\n  targetThursday.setHours(targetThursday.getHours() - ds);\n\n  // Number of weeks between target Thursday and first Thursday\n  var weekDiff = (targetThursday - firstThursday) / (86400000*7);\n  return 1 + Math.floor(weekDiff);\n}\n\n/**\n * Get ISO-8601 numeric representation of the day of the week\n * 1 (for Monday) through 7 (for Sunday)\n * \n * @param  {Object} `date`\n * @return {Number}\n */\nfunction getDayOfWeek(date) {\n  var dow = date.getDay();\n  if(dow === 0) {\n    dow = 7;\n  }\n  return dow;\n}\n\n/**\n * kind-of shortcut\n * @param  {*} val\n * @return {String}\n */\nfunction kindOf(val) {\n  if (val === null) {\n    return 'null';\n  }\n\n  if (val === undefined) {\n    return 'undefined';\n  }\n\n  if (typeof val !== 'object') {\n    return typeof val;\n  }\n\n  if (Array.isArray(val)) {\n    return 'array';\n  }\n\n  return {}.toString.call(val)\n    .slice(8, -1).toLowerCase();\n};\n\n\n\n  if (typeof define === 'function' && define.amd) {\n    define(function () {\n      return dateFormat;\n    });\n  } else if (typeof exports === 'object') {\n    module.exports = dateFormat;\n  } else {\n    global.dateFormat = dateFormat;\n  }\n})(this);\n","/*!\n * pad-left <https://github.com/jonschlinkert/pad-left>\n *\n * Copyright (c) 2014-2015, Jon Schlinkert.\n * Licensed under the MIT license.\n */\n\n'use strict';\n\nvar repeat = require('repeat-string');\n\nmodule.exports = function padLeft(str, num, ch) {\n  str = str.toString();\n\n  if (typeof num === 'undefined') {\n    return str;\n  }\n\n  if (ch === 0) {\n    ch = '0';\n  } else if (ch) {\n    ch = ch.toString();\n  } else {\n    ch = ' ';\n  }\n\n  return repeat(ch, num - str.length) + str;\n};\n","import dateformat from 'dateformat';\nimport assign from 'object-assign';\nimport padLeft from 'pad-left';\nimport { getClientAPI } from './util';\n\nconst noop = () => {};\nlet link;\n\n// Alternative solution for saving files,\n// a bit slower and does not work in Safari\n// function fetchBlobFromDataURL (dataURL) {\n//   return window.fetch(dataURL).then(res => res.blob());\n// }\n\nconst supportedEncodings = [\n  'image/png',\n  'image/jpeg',\n  'image/webp'\n];\n\nexport function exportCanvas (canvas, opt = {}) {\n  const encoding = opt.encoding || 'image/png';\n  if (!supportedEncodings.includes(encoding)) throw new Error(`Invalid canvas encoding ${encoding}`);\n  let extension = (encoding.split('/')[1] || '').replace(/jpeg/i, 'jpg');\n  if (extension) extension = `.${extension}`.toLowerCase();\n  return {\n    extension,\n    type: encoding,\n    dataURL: canvas.toDataURL(encoding, opt.encodingQuality)\n  };\n}\n\nfunction createBlobFromDataURL (dataURL) {\n  return new Promise((resolve) => {\n    const splitIndex = dataURL.indexOf(',');\n    if (splitIndex === -1) {\n      resolve(new window.Blob());\n      return;\n    }\n    const base64 = dataURL.slice(splitIndex + 1);\n    const byteString = window.atob(base64);\n    const mimeMatch = /data:([^;+]);/.exec(dataURL);\n    const mime = (mimeMatch ? mimeMatch[1] : '') || undefined;\n    const ab = new ArrayBuffer(byteString.length);\n    const ia = new Uint8Array(ab);\n    for (var i = 0; i < byteString.length; i++) {\n      ia[i] = byteString.charCodeAt(i);\n    }\n    resolve(new window.Blob([ ab ], { type: mime }));\n  });\n}\n\nexport function saveDataURL (dataURL, opts = {}) {\n  return createBlobFromDataURL(dataURL)\n    .then(blob => saveBlob(blob, opts));\n}\n\nexport function saveBlob (blob, opts = {}) {\n  return new Promise(resolve => {\n    opts = assign({ extension: '', prefix: '', suffix: '' }, opts);\n    const filename = resolveFilename(opts);\n\n    const client = getClientAPI();\n    if (client && typeof client.saveBlob === 'function' && client.output) {\n      // native saving using a CLI tool\n      return client.saveBlob(blob, assign({}, opts, { filename }))\n        .then(ev => resolve(ev));\n    } else {\n      // force download\n      if (!link) {\n        link = document.createElement('a');\n        link.style.visibility = 'hidden';\n        link.target = '_blank';\n      }\n      link.download = filename;\n      link.href = window.URL.createObjectURL(blob);\n      document.body.appendChild(link);\n      link.onclick = () => {\n        link.onclick = noop;\n        setTimeout(() => {\n          window.URL.revokeObjectURL(blob);\n          document.body.removeChild(link);\n          link.removeAttribute('href');\n          resolve({ filename, client: false });\n        });\n      };\n      link.click();\n    }\n  });\n}\n\nexport function saveFile (data, opts = {}) {\n  const parts = Array.isArray(data) ? data : [ data ];\n  const blob = new window.Blob(parts, { type: opts.type || '' });\n  return saveBlob(blob, opts);\n}\n\nexport function getFileName () {\n  const dateFormatStr = `yyyy.mm.dd-HH.MM.ss`;\n  return dateformat(new Date(), dateFormatStr);\n}\n\nexport function getDefaultFile (prefix = '', suffix = '', ext) {\n  // const dateFormatStr = `yyyy.mm.dd-HH.MM.ss`;\n  const dateFormatStr = `yyyy-mm-dd 'at' h.MM.ss TT`;\n  return `${prefix}${dateformat(new Date(), dateFormatStr)}${suffix}${ext}`;\n}\n\nfunction resolveFilename (opt = {}) {\n  opt = assign({}, opt);\n\n  // Custom filename function\n  if (typeof opt.file === 'function') {\n    return opt.file(opt);\n  } else if (opt.file) {\n    return opt.file;\n  }\n\n  let frame = null;\n  let extension = '';\n  if (typeof opt.extension === 'string') extension = opt.extension;\n\n  if (typeof opt.frame === 'number') {\n    let totalFrames;\n    if (typeof opt.totalFrames === 'number') {\n      totalFrames = opt.totalFrames;\n    } else {\n      totalFrames = Math.max(1000, opt.frame);\n    }\n    frame = padLeft(String(opt.frame), String(totalFrames).length, '0');\n  }\n\n  const layerStr = isFinite(opt.totalLayers) && isFinite(opt.layer) && opt.totalLayers > 1 ? `${opt.layer}` : '';\n  if (frame != null) {\n    return [ layerStr, frame ].filter(Boolean).join('-') + extension;\n  } else {\n    const defaultFileName = opt.timeStamp;\n    return [ opt.prefix, opt.name || defaultFileName, layerStr, opt.hash, opt.suffix ].filter(Boolean).join('-') + extension;\n  }\n}\n","const defaultUnits = 'mm';\n\nconst data = [\n  // Common Paper Sizes\n  // (Mostly North-American based)\n  [ 'postcard', 101.6, 152.4 ],\n  [ 'poster-small', 280, 430 ],\n  [ 'poster', 460, 610 ],\n  [ 'poster-large', 610, 910 ],\n  [ 'business-card', 50.8, 88.9 ],\n\n  // Standard Paper Sizes\n  [ 'a0', 841, 1189 ],\n  [ 'a1', 594, 841 ],\n  [ 'a2', 420, 594 ],\n  [ 'a3', 297, 420 ],\n  [ 'a4', 210, 297 ],\n  [ 'a5', 148, 210 ],\n  [ 'a6', 105, 148 ],\n  [ 'a7', 74, 105 ],\n  [ 'a8', 52, 74 ],\n  [ 'a9', 37, 52 ],\n  [ 'a10', 26, 37 ],\n  [ '2a0', 1189, 1682 ],\n  [ '4a0', 1682, 2378 ],\n  [ 'b0', 1000, 1414 ],\n  [ 'b1', 707, 1000 ],\n  [ 'b1+', 720, 1020 ],\n  [ 'b2', 500, 707 ],\n  [ 'b2+', 520, 720 ],\n  [ 'b3', 353, 500 ],\n  [ 'b4', 250, 353 ],\n  [ 'b5', 176, 250 ],\n  [ 'b6', 125, 176 ],\n  [ 'b7', 88, 125 ],\n  [ 'b8', 62, 88 ],\n  [ 'b9', 44, 62 ],\n  [ 'b10', 31, 44 ],\n  [ 'b11', 22, 32 ],\n  [ 'b12', 16, 22 ],\n  [ 'c0', 917, 1297 ],\n  [ 'c1', 648, 917 ],\n  [ 'c2', 458, 648 ],\n  [ 'c3', 324, 458 ],\n  [ 'c4', 229, 324 ],\n  [ 'c5', 162, 229 ],\n  [ 'c6', 114, 162 ],\n  [ 'c7', 81, 114 ],\n  [ 'c8', 57, 81 ],\n  [ 'c9', 40, 57 ],\n  [ 'c10', 28, 40 ],\n  [ 'c11', 22, 32 ],\n  [ 'c12', 16, 22 ],\n\n  // Use inches for North American sizes,\n  // as it produces less float precision errors\n  [ 'half-letter', 5.5, 8.5, 'in' ],\n  [ 'letter', 8.5, 11, 'in' ],\n  [ 'legal', 8.5, 14, 'in' ],\n  [ 'junior-legal', 5, 8, 'in' ],\n  [ 'ledger', 11, 17, 'in' ],\n  [ 'tabloid', 11, 17, 'in' ],\n  [ 'ansi-a', 8.5, 11.0, 'in' ],\n  [ 'ansi-b', 11.0, 17.0, 'in' ],\n  [ 'ansi-c', 17.0, 22.0, 'in' ],\n  [ 'ansi-d', 22.0, 34.0, 'in' ],\n  [ 'ansi-e', 34.0, 44.0, 'in' ],\n  [ 'arch-a', 9, 12, 'in' ],\n  [ 'arch-b', 12, 18, 'in' ],\n  [ 'arch-c', 18, 24, 'in' ],\n  [ 'arch-d', 24, 36, 'in' ],\n  [ 'arch-e', 36, 48, 'in' ],\n  [ 'arch-e1', 30, 42, 'in' ],\n  [ 'arch-e2', 26, 38, 'in' ],\n  [ 'arch-e3', 27, 39, 'in' ]\n];\n\nexport default data.reduce((dict, preset) => {\n  const item = {\n    units: preset[3] || defaultUnits,\n    dimensions: [ preset[1], preset[2] ]\n  };\n  dict[preset[0]] = item;\n  dict[preset[0].replace(/-/g, ' ')] = item;\n  return dict;\n}, {});\n","import paperSizes from './paper-sizes';\nimport convertLength from 'convert-length';\n\nexport function getDimensionsFromPreset (dimensions, unitsTo = 'px', pixelsPerInch = 72) {\n  if (typeof dimensions === 'string') {\n    const key = dimensions.toLowerCase();\n    if (!(key in paperSizes)) {\n      throw new Error(`The dimension preset \"${dimensions}\" is not supported or could not be found; try using a4, a3, postcard, letter, etc.`)\n    }\n    const preset = paperSizes[key];\n    return preset.dimensions.map(d => {\n      return convertDistance(d, preset.units, unitsTo, pixelsPerInch);\n    });\n  } else {\n    return dimensions;\n  }\n}\n\nexport function convertDistance (dimension, unitsFrom = 'px', unitsTo = 'px', pixelsPerInch = 72) {\n  return convertLength(dimension, unitsFrom, unitsTo, {\n    pixelsPerInch,\n    precision: 4,\n    roundPixel: true\n  });\n}\n","import defined from 'defined';\nimport { getDimensionsFromPreset, convertDistance } from '../distances';\nimport { isBrowser } from '../util';\n\nfunction checkIfHasDimensions (settings) {\n  if (!settings.dimensions) return false;\n  if (typeof settings.dimensions === 'string') return true;\n  if (Array.isArray(settings.dimensions) && settings.dimensions.length >= 2) return true;\n  return false;\n}\n\nfunction getParentSize (props, settings) {\n  // When no { dimension } is passed in node, we default to HTML canvas size\n  if (!isBrowser) {\n    return [ 300, 150 ];\n  }\n\n  let element = settings.parent || window;\n\n  if (element === window ||\n      element === document ||\n      element === document.body) {\n    return [ window.innerWidth, window.innerHeight ];\n  } else {\n    const { width, height } = element.getBoundingClientRect();\n    return [ width, height ];\n  }\n}\n\nexport default function resizeCanvas (props, settings) {\n  let width, height;\n  let styleWidth, styleHeight;\n  let canvasWidth, canvasHeight;\n\n  const dimensions = settings.dimensions;\n  const hasDimensions = checkIfHasDimensions(settings);\n  const exporting = props.exporting;\n  const scaleToFit = hasDimensions ? settings.scaleToFit !== false : false;\n  const scaleToView = (!exporting && hasDimensions) ? settings.scaleToView : true;\n  const units = settings.units;\n  const pixelsPerInch = (typeof settings.pixelsPerInch === 'number' && isFinite(settings.pixelsPerInch)) ? settings.pixelsPerInch : 72;\n  const bleed = defined(settings.bleed, 0);\n\n  const devicePixelRatio = isBrowser() ? window.devicePixelRatio : 1;\n  const basePixelRatio = scaleToView ? devicePixelRatio : 1;\n\n  let pixelRatio, exportPixelRatio;\n\n  // If a pixel ratio is specified, we will use it.\n  // Otherwise:\n  //  -> If dimension is specified, use base ratio (i.e. size for export)\n  //  -> If no dimension is specified, use device ratio (i.e. size for screen)\n  if (typeof settings.pixelRatio === 'number' && isFinite(settings.pixelRatio)) {\n    // When { pixelRatio } is specified, it's also used as default exportPixelRatio.\n    pixelRatio = settings.pixelRatio;\n    exportPixelRatio = defined(settings.exportPixelRatio, pixelRatio);\n  } else {\n    if (hasDimensions) {\n      // When a dimension is specified, use the base ratio rather than screen ratio\n      pixelRatio = basePixelRatio;\n      // Default to a pixel ratio of 1 so that you end up with the same dimension\n      // you specified, i.e. [ 500, 500 ] is exported as 500x500 px\n      exportPixelRatio = defined(settings.exportPixelRatio, 1);\n    } else {\n      // No dimension is specified, assume full-screen sizing\n      pixelRatio = devicePixelRatio;\n      // Default to screen pixel ratio, so that it's like taking a device screenshot\n      exportPixelRatio = defined(settings.exportPixelRatio, pixelRatio);\n    }\n  }\n\n  // Clamp pixel ratio\n  if (typeof settings.maxPixelRatio === 'number' && isFinite(settings.maxPixelRatio)) {\n    pixelRatio = Math.min(settings.maxPixelRatio, pixelRatio);\n    exportPixelRatio = Math.min(settings.maxPixelRatio, exportPixelRatio);\n  }\n\n  // Handle export pixel ratio\n  if (exporting) {\n    pixelRatio = exportPixelRatio;\n  }\n\n  // parentWidth = typeof parentWidth === 'undefined' ? defaultNodeSize[0] : parentWidth;\n  // parentHeight = typeof parentHeight === 'undefined' ? defaultNodeSize[1] : parentHeight;\n\n  let [ parentWidth, parentHeight ] = getParentSize(props, settings);\n  let trimWidth, trimHeight;\n\n  // You can specify a dimensions in pixels or cm/m/in/etc\n  if (hasDimensions) {\n    const result = getDimensionsFromPreset(dimensions, units, pixelsPerInch);\n    const highest = Math.max(result[0], result[1]);\n    const lowest = Math.min(result[0], result[1]);\n    if (settings.orientation) {\n      const landscape = settings.orientation === 'landscape';\n      width = landscape ? highest : lowest;\n      height = landscape ? lowest : highest;\n    } else {\n      width = result[0];\n      height = result[1];\n    }\n\n    trimWidth = width;\n    trimHeight = height;\n\n    // Apply bleed which is assumed to be in the same units\n    width += bleed * 2;\n    height += bleed * 2;\n  } else {\n    width = parentWidth;\n    height = parentHeight;\n    trimWidth = width;\n    trimHeight = height;\n  }\n\n  // Real size in pixels after PPI is taken into account\n  let realWidth = width;\n  let realHeight = height;\n  if (hasDimensions && units) {\n    // Convert to digital/pixel units if necessary\n    realWidth = convertDistance(width, units, 'px', pixelsPerInch);\n    realHeight = convertDistance(height, units, 'px', pixelsPerInch);\n  }\n\n  // How big to set the 'view' of the canvas in the browser (i.e. style)\n  styleWidth = Math.round(realWidth);\n  styleHeight = Math.round(realHeight);\n\n  // If we wish to scale the view to the browser window\n  if (scaleToFit && !exporting && hasDimensions) {\n    const aspect = width / height;\n    const windowAspect = parentWidth / parentHeight;\n    const scaleToFitPadding = defined(settings.scaleToFitPadding, 40);\n    const maxWidth = Math.round(parentWidth - scaleToFitPadding * 2);\n    const maxHeight = Math.round(parentHeight - scaleToFitPadding * 2);\n    if (styleWidth > maxWidth || styleHeight > maxHeight) {\n      if (windowAspect > aspect) {\n        styleHeight = maxHeight;\n        styleWidth = Math.round(styleHeight * aspect);\n      } else {\n        styleWidth = maxWidth;\n        styleHeight = Math.round(styleWidth / aspect);\n      }\n    }\n  }\n\n  canvasWidth = scaleToView ? Math.round(pixelRatio * styleWidth) : Math.round(exportPixelRatio * realWidth);\n  canvasHeight = scaleToView ? Math.round(pixelRatio * styleHeight) : Math.round(exportPixelRatio * realHeight);\n\n  const viewportWidth = scaleToView ? Math.round(styleWidth) : Math.round(realWidth);\n  const viewportHeight = scaleToView ? Math.round(styleHeight) : Math.round(realHeight);\n\n  const scaleX = canvasWidth / width;\n  const scaleY = canvasHeight / height;\n\n  // Assign to current props\n  return {\n    bleed,\n    pixelRatio,\n    width,\n    height,\n    dimensions: [ width, height ],\n    units: units || 'px',\n    scaleX,\n    scaleY,\n    viewportWidth,\n    viewportHeight,\n    canvasWidth,\n    canvasHeight,\n    trimWidth,\n    trimHeight,\n    styleWidth,\n    styleHeight\n  };\n}\n","module.exports = getCanvasContext\nfunction getCanvasContext (type, opts) {\n  if (typeof type !== 'string') {\n    throw new TypeError('must specify type string')\n  }\n\n  opts = opts || {}\n\n  if (typeof document === 'undefined' && !opts.canvas) {\n    return null // check for Node\n  }\n\n  var canvas = opts.canvas || document.createElement('canvas')\n  if (typeof opts.width === 'number') {\n    canvas.width = opts.width\n  }\n  if (typeof opts.height === 'number') {\n    canvas.height = opts.height\n  }\n\n  var attribs = opts\n  var gl\n  try {\n    var names = [ type ]\n    // prefix GL contexts\n    if (type.indexOf('webgl') === 0) {\n      names.push('experimental-' + type)\n    }\n\n    for (var i = 0; i < names.length; i++) {\n      gl = canvas.getContext(names[i], attribs)\n      if (gl) return gl\n    }\n  } catch (e) {\n    gl = null\n  }\n  return (gl || null) // ensure null on fail\n}\n","import assign from 'object-assign';\nimport getCanvasContext from 'get-canvas-context';\nimport { isBrowser } from '../util';\n\nfunction createCanvasElement () {\n  if (!isBrowser()) {\n    throw new Error('It appears you are runing from Node.js or a non-browser environment. Try passing in an existing { canvas } interface instead.');\n  }\n  return document.createElement('canvas');\n}\n\nexport default function createCanvas (settings = {}) {\n  let context, canvas;\n  let ownsCanvas = false;\n  if (settings.canvas !== false) {\n    // Determine the canvas and context to create\n    context = settings.context;\n    if (!context || typeof context === 'string') {\n      let newCanvas = settings.canvas;\n      if (!newCanvas) {\n        newCanvas = createCanvasElement();\n        ownsCanvas = true;\n      }\n      const type = context || '2d';\n      if (typeof newCanvas.getContext !== 'function') {\n        throw new Error(`The specified { canvas } element does not have a getContext() function, maybe it is not a <canvas> tag?`);\n      }\n      context = getCanvasContext(type, assign({}, settings.attributes, { canvas: newCanvas }));\n      if (!context) {\n        throw new Error(`Failed at canvas.getContext('${type}') - the browser may not support this context, or a different context may already be in use with this canvas.`);\n      }\n    }\n\n    canvas = context.canvas;\n    // Ensure context matches user's canvas expectations\n    if (settings.canvas && canvas !== settings.canvas) {\n      throw new Error('The { canvas } and { context } settings must point to the same underlying canvas element');\n    }\n\n    // Apply pixelation to canvas if necessary, this is mostly a convenience utility\n    if (settings.pixelated) {\n      context.imageSmoothingEnabled = false;\n      context.mozImageSmoothingEnabled = false;\n      context.oImageSmoothingEnabled = false;\n      context.webkitImageSmoothingEnabled = false;\n      context.msImageSmoothingEnabled = false;\n      canvas.style['image-rendering'] = 'pixelated';\n    }\n  }\n  return { canvas, context, ownsCanvas };\n}\n","import defined from 'defined';\nimport assign from 'object-assign';\nimport rightNow from 'right-now';\nimport isPromise from 'is-promise';\nimport { isBrowser, isWebGLContext, isCanvas, getClientAPI } from '../util';\nimport deepEqual from 'deep-equal';\nimport { saveFile, saveDataURL, getFileName, exportCanvas } from '../save';\n\nimport keyboardShortcuts from './keyboardShortcuts';\nimport resizeCanvas from './resizeCanvas';\nimport createCanvas from './createCanvas';\n\nclass SketchManager {\n  constructor () {\n    this._settings = {};\n    this._props = {};\n    this._sketch = undefined;\n    this._raf = null;\n\n    // Some hacky things required to get around p5.js structure\n    this._lastRedrawResult = undefined;\n    this._isP5Resizing = false;\n\n    this._keyboardShortcuts = keyboardShortcuts({\n      enabled: () => this.settings.hotkeys !== false,\n      save: (ev) => {\n        if (ev.shiftKey) {\n          if (this.props.recording) {\n            this.endRecord();\n            this.play();\n          } else this.record();\n        } else this.exportFrame();\n      },\n      togglePlay: () => {\n        if (this.props.playing) this.pause();\n        else this.play();\n      },\n      commit: (ev) => {\n        this.exportFrame({ commit: true });\n      }\n    });\n\n    this._animateHandler = () => this.animate();\n\n    this._resizeHandler = () => {\n      const changed = this.resize();\n      // Only re-render when size actually changes\n      if (changed) {\n        this.render();\n      }\n    };\n  }\n\n  get sketch () {\n    return this._sketch;\n  }\n\n  get settings () {\n    return this._settings;\n  }\n\n  get props () {\n    return this._props;\n  }\n\n  _computePlayhead (currentTime, duration) {\n    const hasDuration = typeof duration === 'number' && isFinite(duration);\n    return hasDuration ? currentTime / duration : 0;\n  }\n\n  _computeFrame (playhead, time, totalFrames, fps) {\n    return (isFinite(totalFrames) && totalFrames > 1)\n      ? Math.floor(playhead * (totalFrames - 1))\n      : Math.floor(fps * time);\n  }\n\n  _computeCurrentFrame () {\n    return this._computeFrame(\n      this.props.playhead, this.props.time,\n      this.props.totalFrames, this.props.fps\n    );\n  }\n\n  _getSizeProps () {\n    const props = this.props;\n    return {\n      width: props.width,\n      height: props.height,\n      pixelRatio: props.pixelRatio,\n      canvasWidth: props.canvasWidth,\n      canvasHeight: props.canvasHeight,\n      viewportWidth: props.viewportWidth,\n      viewportHeight: props.viewportHeight\n    };\n  }\n\n  run () {\n    if (!this.sketch) throw new Error('should wait until sketch is loaded before trying to play()');\n\n    // Start an animation frame loop if necessary\n    if (this.settings.playing !== false) {\n      this.play();\n    }\n\n    // Let's let this warning hang around for a few versions...\n    if (typeof this.sketch.dispose === 'function') {\n      console.warn('In canvas-sketch@0.0.23 the dispose() event has been renamed to unload()');\n    }\n\n    // In case we aren't playing or animated, make sure we still trigger begin message...\n    if (!this.props.started) {\n      this._signalBegin();\n      this.props.started = true;\n    }\n\n    // Render an initial frame\n    this.tick();\n    this.render();\n    return this;\n  }\n\n  play () {\n    let animate = this.settings.animate;\n    if ('animation' in this.settings) {\n      animate = true;\n      console.warn('[canvas-sketch] { animation } has been renamed to { animate }');\n    }\n    if (!animate) return;\n    if (!isBrowser()) {\n      console.error('[canvas-sketch] WARN: Using { animate } in Node.js is not yet supported');\n      return;\n    }\n    if (this.props.playing) return;\n    if (!this.props.started) {\n      this._signalBegin();\n      this.props.started = true;\n    }\n\n    // console.log('play', this.props.time)\n\n    // Start a render loop\n    this.props.playing = true;\n    if (this._raf != null) window.cancelAnimationFrame(this._raf);\n    this._lastTime = rightNow();\n    this._raf = window.requestAnimationFrame(this._animateHandler);\n  }\n\n  pause () {\n    if (this.props.recording) this.endRecord();\n    this.props.playing = false;\n\n    // console.log('pause', this.props.time)\n    if (this._raf != null && isBrowser()) window.cancelAnimationFrame(this._raf);\n  }\n\n  togglePlay () {\n    if (this.props.playing) this.pause();\n    else this.play();\n  }\n\n  // Stop and reset to frame zero\n  stop () {\n    this.pause();\n    this.props.frame = 0;\n    this.props.playhead = 0;\n    this.props.time = 0;\n    this.props.deltaTime = 0;\n    this.props.started = false;\n    this.render();\n  }\n\n  record () {\n    if (this.props.recording) return;\n    if (!isBrowser()) {\n      console.error('[canvas-sketch] WARN: Recording from Node.js is not yet supported');\n      return;\n    }\n    this.stop();\n    this.props.playing = true;\n    this.props.recording = true;\n\n    const frameInterval = 1 / this.props.fps;\n    // Render each frame in the sequence\n    if (this._raf != null) window.cancelAnimationFrame(this._raf);\n    const tick = () => {\n      if (!this.props.recording) return Promise.resolve();\n      this.props.deltaTime = frameInterval;\n      this.tick();\n      return this.exportFrame({ sequence: true })\n        .then(() => {\n          if (!this.props.recording) return; // was cancelled before\n          this.props.deltaTime = 0;\n          this.props.frame++;\n          if (this.props.frame < this.props.totalFrames) {\n            this.props.time += frameInterval;\n            this.props.playhead = this._computePlayhead(this.props.time, this.props.duration);\n            this._raf = window.requestAnimationFrame(tick);\n          } else {\n            console.log('Finished recording');\n            this._signalEnd();\n            this.endRecord();\n            this.stop();\n            this.run();\n          }\n        });\n    };\n\n    // Trigger a start event before we begin recording\n    if (!this.props.started) {\n      this._signalBegin();\n      this.props.started = true;\n    }\n\n    this._raf = window.requestAnimationFrame(tick);\n  }\n\n  _signalBegin () {\n    if (this.sketch && typeof this.sketch.begin === 'function') {\n      this._wrapContextScale(props => this.sketch.begin(props));\n    }\n  }\n\n  _signalEnd () {\n    if (this.sketch && typeof this.sketch.end === 'function') {\n      this._wrapContextScale(props => this.sketch.end(props));\n    }\n  }\n\n  endRecord () {\n    if (this._raf != null && isBrowser()) window.cancelAnimationFrame(this._raf);\n    this.props.recording = false;\n    this.props.deltaTime = 0;\n  }\n\n  exportFrame (opt = {}) {\n    if (!this.sketch) return Promise.all([]);\n    if (typeof this.sketch.preExport === 'function') {\n      this.sketch.preExport();\n    }\n\n    // Options for export function\n    let exportOpts = assign({\n      sequence: opt.sequence,\n      frame: opt.sequence ? this.props.frame : undefined,\n      file: this.settings.file,\n      name: this.settings.name,\n      prefix: this.settings.prefix,\n      suffix: this.settings.suffix,\n      encoding: this.settings.encoding,\n      encodingQuality: this.settings.encodingQuality,\n      timeStamp: getFileName(),\n      totalFrames: isFinite(this.props.totalFrames) ? Math.max(100, this.props.totalFrames) : 1000\n    });\n\n    const client = getClientAPI();\n    let p = Promise.resolve();\n    if (client && opt.commit && typeof client.commit === 'function') {\n      const commitOpts = assign({}, exportOpts);\n      const hash = client.commit(commitOpts);\n      if (isPromise(hash)) p = hash;\n      else p = Promise.resolve(hash);\n    }\n\n    return p.then(hash => {\n      return this._doExportFrame(assign({}, exportOpts, { hash: hash || '' }));\n    });\n  }\n\n  _doExportFrame (exportOpts = {}) {\n    this._props.exporting = true;\n\n    // Resize to output resolution\n    this.resize();\n\n    // Draw at this output resolution\n    let drawResult = this.render();\n\n    // The self owned canvas (may be undefined...!)\n    const canvas = this.props.canvas;\n\n    // Get list of results from render\n    if (typeof drawResult === 'undefined') {\n      drawResult = [ canvas ];\n    }\n    drawResult = [].concat(drawResult).filter(Boolean);\n\n    // Transform the canvas/file descriptors into a consistent format,\n    // and pull out any data URLs from canvas elements\n    drawResult = drawResult.map(result => {\n      const hasDataObject = typeof result === 'object' && result && ('data' in result || 'dataURL' in result);\n      const data = hasDataObject ? result.data : result;\n      const opts = hasDataObject ? assign({}, result, { data }) : { data };\n      if (isCanvas(data)) {\n        const encoding = opts.encoding || exportOpts.encoding;\n        const encodingQuality = defined(opts.encodingQuality, exportOpts.encodingQuality, 0.95);\n        const { dataURL, extension, type } = exportCanvas(data, { encoding, encodingQuality });\n        return Object.assign(opts, { dataURL, extension, type });\n      } else {\n        return opts;\n      }\n    });\n\n    // Now return to regular rendering mode\n    this._props.exporting = false;\n    this.resize();\n    this.render();\n\n    // And now we can save each result\n    return Promise.all(drawResult.map((result, i, layerList) => {\n      // By default, if rendering multiple layers we will give them indices\n      const curOpt = assign({}, exportOpts, result, { layer: i, totalLayers: layerList.length });\n      const data = result.data;\n      if (result.dataURL) {\n        const dataURL = result.dataURL;\n        delete curOpt.dataURL; // avoid sending entire base64 data around\n        return saveDataURL(dataURL, curOpt);\n      } else {\n        return saveFile(data, curOpt);\n      }\n    })).then(ev => {\n      if (ev.length > 0) {\n        const eventWithOutput = ev.find(e => e.outputName);\n        const isClient = ev.some(e => e.client);\n        let item;\n        // many files, just log how many were exported\n        if (ev.length > 1) item = ev.length;\n        // in CLI, we know exact path dirname\n        else if (eventWithOutput) item = `${eventWithOutput.outputName}/${ev[0].filename}`;\n        // in browser, we can only know it went to \"browser download folder\"\n        else item = `${ev[0].filename}`;\n        let ofSeq = '';\n        if (exportOpts.sequence) {\n          const hasTotalFrames = isFinite(this.props.totalFrames);\n          ofSeq = hasTotalFrames ? ` (frame ${exportOpts.frame + 1} / ${this.props.totalFrames})` : ` (frame ${exportOpts.frame})`;\n        } else if (ev.length > 1) {\n          ofSeq = ` files`;\n        }\n        const client = isClient ? 'canvas-sketch-cli' : 'canvas-sketch';\n        console.log(`%c[${client}]%c Exported %c${item}%c${ofSeq}`, 'color: #8e8e8e;', 'color: initial;', 'font-weight: bold;', 'font-weight: initial;');\n      }\n      if (typeof this.sketch.postExport === 'function') {\n        this.sketch.postExport();\n      }\n    });\n  }\n\n  _wrapContextScale (cb) {\n    this._preRender();\n    cb(this.props);\n    this._postRender();\n  }\n\n  _preRender () {\n    const props = this.props;\n\n    // Scale context for unit sizing\n    if (!this.props.gl && props.context && !props.p5) {\n      props.context.save();\n      if (this.settings.scaleContext !== false) {\n        props.context.scale(props.scaleX, props.scaleY);\n      }\n    } else if (props.p5) {\n      props.p5.scale(props.scaleX / props.pixelRatio, props.scaleY / props.pixelRatio);\n    }\n  }\n\n  _postRender () {\n    const props = this.props;\n\n    if (!this.props.gl && props.context && !props.p5) {\n      props.context.restore();\n    }\n\n    // Flush by default, this may be revisited at a later point.\n    // We do this to ensure toDataURL can be called immediately after.\n    // Most likely browsers already handle this, so we may revisit this and\n    // remove it if it improves performance without any usability issues.\n    if (props.gl && this.settings.flush !== false && !props.p5) {\n      props.gl.flush();\n    }\n  }\n\n  tick () {\n    if (this.sketch && typeof this.sketch.tick === 'function') {\n      this._preRender();\n      this.sketch.tick(this.props);\n      this._postRender();\n    }\n  }\n\n  render () {\n    if (this.props.p5) {\n      this._lastRedrawResult = undefined;\n      this.props.p5.redraw();\n      return this._lastRedrawResult;\n    } else {\n      return this.submitDrawCall();\n    }\n  }\n\n  submitDrawCall () {\n    if (!this.sketch) return;\n\n    const props = this.props;\n    this._preRender();\n\n    let drawResult;\n\n    if (typeof this.sketch === 'function') {\n      drawResult = this.sketch(props);\n    } else if (typeof this.sketch.render === 'function') {\n      drawResult = this.sketch.render(props);\n    }\n\n    this._postRender();\n\n    return drawResult;\n  }\n\n  update (opt = {}) {\n    // Currently update() is only focused on resizing,\n    // but later we will support other options like switching\n    // frames and such.\n    const notYetSupported = [\n      'animate'\n    ];\n\n    Object.keys(opt).forEach(key => {\n      if (notYetSupported.indexOf(key) >= 0) {\n        throw new Error(`Sorry, the { ${key} } option is not yet supported with update().`);\n      }\n    });\n\n    const oldCanvas = this._settings.canvas;\n    const oldContext = this._settings.context;\n\n    // Merge new options into settings\n    for (let key in opt) {\n      const value = opt[key];\n      if (typeof value !== 'undefined') { // ignore undefined\n        this._settings[key] = value;\n      }\n    }\n\n    // Merge in time props\n    const timeOpts = Object.assign({}, this._settings, opt);\n    if ('time' in opt && 'frame' in opt) throw new Error('You should specify { time } or { frame } but not both');\n    else if ('time' in opt) delete timeOpts.frame;\n    else if ('frame' in opt) delete timeOpts.time;\n    if ('duration' in opt && 'totalFrames' in opt) throw new Error('You should specify { duration } or { totalFrames } but not both');\n    else if ('duration' in opt) delete timeOpts.totalFrames;\n    else if ('totalFrames' in opt) delete timeOpts.duration;\n\n    const timeProps = this.getTimeProps(timeOpts);\n    Object.assign(this._props, timeProps);\n\n    // If either canvas or context is changed, we should re-update\n    if (oldCanvas !== this._settings.canvas || oldContext !== this._settings.context) {\n      const { canvas, context } = createCanvas(this._settings);\n\n      this.props.canvas = canvas;\n      this.props.context = context;\n\n      // Delete or add a 'gl' prop for convenience\n      this._setupGLKey();\n\n      // Re-mount the new canvas if it has no parent\n      this._appendCanvasIfNeeded();\n    }\n\n    // Special case to support P5.js\n    if (opt.p5 && typeof opt.p5 !== 'function') {\n      this.props.p5 = opt.p5;\n      this.props.p5.draw = () => {\n        if (this._isP5Resizing) return;\n        this._lastRedrawResult = this.submitDrawCall();\n      };\n    }\n\n    // Update playing state if necessary\n    if ('playing' in opt) {\n      if (opt.playing) this.play();\n      else this.pause();\n    }\n\n    // Draw new frame\n    this.resize();\n    this.render();\n    return this.props;\n  }\n\n  resize () {\n    const oldSizes = this._getSizeProps();\n\n    const settings = this.settings;\n    const props = this.props;\n\n    // Recompute new properties based on current setup\n    const newProps = resizeCanvas(props, settings);\n\n    // Assign to current props\n    Object.assign(this._props, newProps);\n\n    // Now we actually update the canvas width/height and style props\n    const {\n      pixelRatio,\n      canvasWidth,\n      canvasHeight,\n      styleWidth,\n      styleHeight\n    } = this.props;\n\n    // Update canvas settings\n    const canvas = this.props.canvas;\n    if (canvas && settings.resizeCanvas !== false) {\n      if (props.p5) {\n        // P5.js specific edge case\n        if (canvas.width !== canvasWidth || canvas.height !== canvasHeight) {\n          this._isP5Resizing = true;\n          // This causes a re-draw :\\ so we ignore draws in the mean time... sorta hacky\n          props.p5.pixelDensity(pixelRatio);\n          props.p5.resizeCanvas(canvasWidth / pixelRatio, canvasHeight / pixelRatio, false);\n          this._isP5Resizing = false;\n        }\n      } else {\n        // Force canvas size\n        if (canvas.width !== canvasWidth) canvas.width = canvasWidth;\n        if (canvas.height !== canvasHeight) canvas.height = canvasHeight;\n      }\n      // Update canvas style\n      if (isBrowser() && settings.styleCanvas !== false) {\n        canvas.style.width = `${styleWidth}px`;\n        canvas.style.height = `${styleHeight}px`;\n      }\n    }\n\n    const newSizes = this._getSizeProps();\n    let changed = !deepEqual(oldSizes, newSizes);\n    if (changed) {\n      this._sizeChanged();\n    }\n    return changed;\n  }\n\n  _sizeChanged () {\n    // Send resize event to sketch\n    if (this.sketch && typeof this.sketch.resize === 'function') {\n      this.sketch.resize(this.props);\n    }\n  }\n\n  animate () {\n    if (!this.props.playing) return;\n    if (!isBrowser()) {\n      console.error('[canvas-sketch] WARN: Animation in Node.js is not yet supported');\n      return;\n    }\n    this._raf = window.requestAnimationFrame(this._animateHandler);\n\n    let now = rightNow();\n\n    const fps = this.props.fps;\n    const frameIntervalMS = 1000 / fps;\n    let deltaTimeMS = now - this._lastTime;\n\n    const duration = this.props.duration;\n    const hasDuration = typeof duration === 'number' && isFinite(duration);\n\n    let isNewFrame = true;\n    const playbackRate = this.settings.playbackRate;\n    if (playbackRate === 'fixed') {\n      deltaTimeMS = frameIntervalMS;\n    } else if (playbackRate === 'throttle') {\n      if (deltaTimeMS > frameIntervalMS) {\n        now = now - (deltaTimeMS % frameIntervalMS);\n        this._lastTime = now;\n      } else {\n        isNewFrame = false;\n      }\n    } else {\n      this._lastTime = now;\n    }\n\n    const deltaTime = deltaTimeMS / 1000;\n    let newTime = this.props.time + deltaTime * this.props.timeScale;\n\n    // Handle reverse time scale\n    if (newTime < 0 && hasDuration) {\n      newTime = duration + newTime;\n    }\n\n    // Re-start animation\n    let isFinished = false;\n    let isLoopStart = false;\n\n    const looping = this.settings.loop !== false;\n    if (hasDuration && newTime >= duration) {\n      // Re-start animation\n      if (looping) {\n        isNewFrame = true;\n        newTime = newTime % duration;\n        isLoopStart = true;\n      } else {\n        isNewFrame = false;\n        newTime = duration;\n        isFinished = true;\n      }\n\n      this._signalEnd();\n    }\n\n    if (isNewFrame) {\n      this.props.deltaTime = deltaTime;\n      this.props.time = newTime;\n      this.props.playhead = this._computePlayhead(newTime, duration);\n      const lastFrame = this.props.frame;\n      this.props.frame = this._computeCurrentFrame();\n      if (isLoopStart) this._signalBegin();\n      if (lastFrame !== this.props.frame) this.tick();\n      this.render();\n      this.props.deltaTime = 0;\n    }\n\n    if (isFinished) {\n      this.pause();\n    }\n  }\n\n  dispatch (cb) {\n    if (typeof cb !== 'function') throw new Error('must pass function into dispatch()');\n    cb(this.props);\n    this.render();\n  }\n\n  mount () {\n    this._appendCanvasIfNeeded();\n  }\n\n  unmount () {\n    if (isBrowser()) {\n      window.removeEventListener('resize', this._resizeHandler);\n      this._keyboardShortcuts.detach();\n    }\n    if (this.props.canvas.parentElement) {\n      this.props.canvas.parentElement.removeChild(this.props.canvas);\n    }\n  }\n\n  _appendCanvasIfNeeded () {\n    if (!isBrowser()) return;\n    if (this.settings.parent !== false && (this.props.canvas && !this.props.canvas.parentElement)) {\n      const defaultParent = this.settings.parent || document.body;\n      defaultParent.appendChild(this.props.canvas);\n    }\n  }\n\n  _setupGLKey () {\n    if (this.props.context) {\n      if (isWebGLContext(this.props.context)) {\n        this._props.gl = this.props.context;\n      } else {\n        delete this._props.gl;\n      }\n    }\n  }\n\n  getTimeProps (settings = {}) {\n    // Get timing data\n    let duration = settings.duration;\n    let totalFrames = settings.totalFrames;\n    const timeScale = defined(settings.timeScale, 1);\n    const fps = defined(settings.fps, 24);\n    const hasDuration = typeof duration === 'number' && isFinite(duration);\n    const hasTotalFrames = typeof totalFrames === 'number' && isFinite(totalFrames);\n\n    const totalFramesFromDuration = hasDuration ? Math.floor(fps * duration) : undefined;\n    const durationFromTotalFrames = hasTotalFrames ? (totalFrames / fps) : undefined;\n    if (hasDuration && hasTotalFrames && totalFramesFromDuration !== totalFrames) {\n      throw new Error('You should specify either duration or totalFrames, but not both. Or, they must match exactly.');\n    }\n\n    if (typeof settings.dimensions === 'undefined' && typeof settings.units !== 'undefined') {\n      console.warn(`You've specified a { units } setting but no { dimension }, so the units will be ignored.`);\n    }\n\n    totalFrames = defined(totalFrames, totalFramesFromDuration, Infinity);\n    duration = defined(duration, durationFromTotalFrames, Infinity);\n\n    const startTime = settings.time;\n    const startFrame = settings.frame;\n    const hasStartTime = typeof startTime === 'number' && isFinite(startTime);\n    const hasStartFrame = typeof startFrame === 'number' && isFinite(startFrame);\n\n    // start at zero unless user specifies frame or time (but not both mismatched)\n    let time = 0;\n    let frame = 0;\n    let playhead = 0;\n    if (hasStartTime && hasStartFrame) {\n      throw new Error('You should specify either start frame or time, but not both.');\n    } else if (hasStartTime) {\n      // User specifies time, we infer frames from FPS\n      time = startTime;\n      playhead = this._computePlayhead(time, duration);\n      frame = this._computeFrame(\n        playhead, time,\n        totalFrames, fps\n      );\n    } else if (hasStartFrame) {\n      // User specifies frame number, we infer time from FPS\n      frame = startFrame;\n      time = frame / fps;\n      playhead = this._computePlayhead(time, duration);\n    }\n\n    return {\n      playhead,\n      time,\n      frame,\n      duration,\n      totalFrames,\n      fps,\n      timeScale\n    };\n  }\n\n  setup (settings = {}, overrides = {}) {\n    if (this.sketch) throw new Error('Multiple setup() calls not yet supported.');\n\n    this._settings = Object.assign({}, settings, this._settings);\n\n    // Get initial canvas & context\n    const { context, canvas } = createCanvas(this._settings);\n\n    const timeProps = this.getTimeProps(this._settings);\n\n    // Initial render state features\n    this._props = {\n      ...timeProps,\n      canvas,\n      context,\n      deltaTime: 0,\n      started: false,\n      exporting: false,\n      playing: false,\n      recording: false,\n      settings: this.settings,\n\n      // Export some specific actions to the sketch\n      render: () => this.render(),\n      togglePlay: () => this.togglePlay(),\n      dispatch: (cb) => this.dispatch(cb),\n      tick: () => this.tick(),\n      resize: () => this.resize(),\n      update: (opt) => this.update(opt),\n      exportFrame: opt => this.exportFrame(opt),\n      record: () => this.record(),\n      play: () => this.play(),\n      pause: () => this.pause(),\n      stop: () => this.stop()\n    };\n\n    // For WebGL sketches, a gl variable reads a bit better\n    this._setupGLKey();\n\n    // Trigger initial resize now so that canvas is already sized\n    // by the time we load the sketch\n    this.resize();\n  }\n\n  loadAndRun (canvasSketch, newSettings) {\n    return this.load(canvasSketch, newSettings).then(() => {\n      this.run();\n      return this;\n    });\n  }\n\n  unload () {\n    this.pause();\n    if (!this.sketch) return;\n    if (typeof this.sketch.unload === 'function') {\n      this._wrapContextScale(props => this.sketch.unload(props));\n    }\n    this._sketch = null;\n  }\n\n  destroy () {\n    this.unload();\n    this.unmount();\n  }\n\n  load (createSketch, newSettings) {\n    // User didn't specify a function\n    if (typeof createSketch !== 'function') {\n      throw new Error('The function must take in a function as the first parameter. Example:\\n  canvasSketcher(() => { ... }, settings)');\n    }\n\n    if (this.sketch) {\n      this.unload();\n    }\n\n    if (typeof newSettings !== 'undefined') {\n      this.update(newSettings);\n    }\n\n    // This is a bit of a tricky case; we set up the auto-scaling here\n    // in case the user decides to render anything to the context *before* the\n    // render() function... However, users should instead use begin() function for that.\n    this._preRender();\n\n    let preload = Promise.resolve();\n\n    // Because of P5.js's unusual structure, we have to do a bit of\n    // library-specific changes to support it properly.\n    if (this.settings.p5) {\n      if (!isBrowser()) {\n        throw new Error('[canvas-sketch] ERROR: Using p5.js in Node.js is not supported');\n      }\n      preload = new Promise(resolve => {\n        let P5Constructor = this.settings.p5;\n        let preload;\n        if (P5Constructor.p5) {\n          preload = P5Constructor.preload;\n          P5Constructor = P5Constructor.p5;\n        }\n\n        // The sketch setup; disable loop, set sizing, etc.\n        const p5Sketch = p5 => {\n          // Hook in preload if necessary\n          if (preload) p5.preload = () => preload(p5);\n          p5.setup = () => {\n            const props = this.props;\n            const isGL = this.settings.context === 'webgl';\n            const renderer = isGL ? p5.WEBGL : p5.P2D;\n            p5.noLoop();\n            p5.pixelDensity(props.pixelRatio);\n            p5.createCanvas(props.viewportWidth, props.viewportHeight, renderer);\n            if (isGL && this.settings.attributes) {\n              p5.setAttributes(this.settings.attributes);\n            }\n\n            this.update({ p5, canvas: p5.canvas, context: p5._renderer.drawingContext });\n            resolve();\n          };\n        };\n\n        // Support global and instance P5.js modes\n        if (typeof P5Constructor === 'function') {\n          new P5Constructor(p5Sketch);\n        } else {\n          if (typeof window.createCanvas !== 'function') {\n            throw new Error(\"{ p5 } setting is passed but can't find p5.js in global (window) scope. Maybe you did not create it globally?\\nnew p5(); // <-- attaches to global scope\");\n          }\n          p5Sketch(window);\n        }\n      });\n    }\n\n    return preload.then(() => {\n      // Load the user's sketch\n      let loader = createSketch(this.props);\n      if (!isPromise(loader)) {\n        loader = Promise.resolve(loader);\n      }\n      return loader;\n    }).then(sketch => {\n      if (!sketch) sketch = {};\n      this._sketch = sketch;\n\n      // Once the sketch is loaded we can add the events\n      if (isBrowser()) {\n        this._keyboardShortcuts.attach();\n        window.addEventListener('resize', this._resizeHandler);\n      }\n\n      this._postRender();\n\n      // The initial resize() in the constructor will not have\n      // triggered a resize() event on the sketch, since it was before\n      // the sketch was loaded. So we send the signal here, allowing\n      // users to react to the initial size before first render.\n      this._sizeChanged();\n      return this;\n    }).catch(err => {\n      console.warn('Could not start sketch, the async loading function rejected with an error:\\n    Error: ' + err.message);\n      throw err;\n    });\n  }\n}\n\nexport default SketchManager;\n","import { getClientAPI } from '../util';\n\nexport default function (opt = {}) {\n  const handler = ev => {\n    if (!opt.enabled()) return;\n\n    const client = getClientAPI();\n    if (ev.keyCode === 83 && !ev.altKey && (ev.metaKey || ev.ctrlKey)) {\n      // Cmd + S\n      ev.preventDefault();\n      opt.save(ev);\n    } else if (ev.keyCode === 32) {\n      // Space\n      // TODO: what to do with this? keep it, or remove it?\n      opt.togglePlay(ev);\n    } else if (client && !ev.altKey && ev.keyCode === 75 && (ev.metaKey || ev.ctrlKey)) {\n      // Cmd + K, only when canvas-sketch-cli is used\n      ev.preventDefault();\n      opt.commit(ev);\n    }\n  };\n\n  const attach = () => {\n    window.addEventListener('keydown', handler);\n  };\n\n  const detach = () => {\n    window.removeEventListener('keydown', handler);\n  };\n\n  return {\n    attach,\n    detach\n  };\n}\n","import SketchManager from './core/SketchManager';\nimport PaperSizes from './paper-sizes';\nimport { getClientAPI } from './util';\nimport defined from 'defined';\n\nconst CACHE = 'canvas-sketch-file-cache';\nlet runtimeCache;\n\nfunction isHotReload () {\n  const client = getClientAPI();\n  return client && client.hot;\n}\n\nfunction cacheGet (file) {\n  if (typeof window === 'undefined') return undefined;\n  window[CACHE] = window[CACHE] || {};\n  return window[CACHE][file];\n}\n\nfunction cachePut (file, data) {\n  if (typeof window === 'undefined') return undefined;\n  if (!runtimeCache) runtimeCache = {};\n  runtimeCache[file] = data;\n  window[CACHE] = window[CACHE] || {};\n  window[CACHE][file] = data;\n}\n\nfunction getTimeProp (oldManager, newSettings) {\n  // Static sketches ignore the time persistency\n  return newSettings.animate ? { time: oldManager.props.time } : undefined;\n}\n\nfunction canvasSketch (sketch, settings = {}) {\n  if (settings.p5) {\n    if (settings.canvas || (settings.context && typeof settings.context !== 'string')) {\n      throw new Error(`In { p5 } mode, you can't pass your own canvas or context, unless the context is a \"webgl\" or \"2d\" string`);\n    }\n\n    // Do not create a canvas on startup, since P5.js does that for us\n    const context = typeof settings.context === 'string' ? settings.context : false;\n    settings = Object.assign({}, settings, { canvas: false, context });\n  }\n\n  const isHot = isHotReload();\n  let file;\n  if (isHot) {\n    file = defined(settings.id, process.env.SKETCH_ENTRY);\n  }\n  const isInjecting = isHot && typeof file === 'string';\n  let preload = Promise.resolve();\n\n  if (isInjecting) {\n    const previousData = cacheGet(file);\n    if (previousData) {\n      const next = () => {\n        // Grab new props from old sketch instance\n        const newProps = getTimeProp(previousData.manager, settings);\n        // Destroy the old instance\n        previousData.manager.destroy();\n        // Pass along new props\n        return newProps;\n      };\n\n      // Move along the next data...\n      preload = previousData.load.then(next).catch(next);\n    }\n  }\n\n  return preload.then(newProps => {\n    const manager = new SketchManager();\n    let result;\n    if (sketch) {\n      // Merge with incoming data\n      settings = Object.assign({}, settings, newProps);\n\n      // Apply settings and create a canvas\n      manager.setup(settings);\n\n      // Mount to DOM\n      manager.mount();\n\n      // load the sketch first\n      result = manager.loadAndRun(sketch);\n    } else {\n      result = Promise.resolve(manager);\n    }\n    if (isInjecting) {\n      cachePut(file, { load: result, manager });\n    }\n    return result;\n  });\n}\n\n// TODO: Figure out a nice way to export things.\ncanvasSketch.canvasSketch = canvasSketch;\ncanvasSketch.PaperSizes = PaperSizes;\n\nexport default canvasSketch;\n"],"names":["i","arguments","length","undefined","getOwnPropertySymbols","Object","hasOwnProperty","prototype","propIsEnumerable","propertyIsEnumerable","assign","test1","String","getOwnPropertyNames","test2","fromCharCode","map","n","join","test3","split","forEach","letter","keys","err","shouldUseNative","target","source","from","symbols","to","val","TypeError","toObject","s","key","call","global","performance","now","Date","obj","then","window","Node","nodeType","nodeName","getClientAPI","isBrowser","document","cache","shim","push","module","supportsArgumentsClass","toString","supported","object","unsupported","exports","pSlice","Array","slice","deepEqual","actual","expected","opts","getTime","strict","a","b","isUndefinedOrNull","isArguments","isBuffer","ka","objectKeys","kb","e","sort","objEquiv","value","x","copy","token","timezone","timezoneClip","dateFormat","date","mask","utc","gmt","isArray","toLowerCase","test","isNaN","maskSlice","masks","_","d","D","m","y","H","M","L","o","getTimezoneOffset","W","targetThursday","getFullYear","getMonth","getDate","setDate","getDay","firstThursday","ds","setHours","getHours","Math","floor","getWeek","N","dow","getDayOfWeek","flags","dd","pad","ddd","i18n","dayNames","dddd","mm","mmm","monthNames","mmmm","yy","yyyy","h","hh","HH","MM","ss","l","round","t","timeNames","tt","T","TT","Z","match","pop","replace","abs","S","len","default","shortDate","mediumDate","longDate","fullDate","shortTime","mediumTime","longTime","isoDate","isoTime","isoDateTime","isoUtcDateTime","expiresHeaderFormat","res","str","num","max","substr","link","ch","repeat","noop","supportedEncodings","saveDataURL","dataURL","Promise","resolve","const","splitIndex","indexOf","base64","byteString","atob","mimeMatch","exec","mime","ab","ArrayBuffer","ia","Uint8Array","charCodeAt","Blob","type","createBlobFromDataURL","blob","saveBlob","filename","opt","file","let","frame","extension","totalFrames","padLeft","layerStr","isFinite","totalLayers","layer","filter","Boolean","defaultFileName","timeStamp","prefix","name","hash","suffix","resolveFilename","client","output","ev","createElement","style","visibility","download","href","URL","createObjectURL","body","appendChild","onclick","setTimeout","revokeObjectURL","removeChild","removeAttribute","click","reduce","dict","preset","item","units","dimensions","convertDistance","dimension","unitsFrom","unitsTo","pixelsPerInch","convertLength","precision","roundPixel","resizeCanvas","props","settings","width","height","styleWidth","styleHeight","canvasWidth","canvasHeight","pixelRatio","exportPixelRatio","hasDimensions","checkIfHasDimensions","exporting","scaleToFit","scaleToView","bleed","defined","devicePixelRatio","basePixelRatio","maxPixelRatio","min","trimWidth","trimHeight","element","parent","innerWidth","innerHeight","getBoundingClientRect","getParentSize","result","paperSizes","Error","getDimensionsFromPreset","highest","lowest","orientation","landscape","parentWidth","parentHeight","realWidth","realHeight","aspect","windowAspect","scaleToFitPadding","maxWidth","maxHeight","viewportWidth","viewportHeight","canvas","gl","attribs","names","getContext","createCanvas","context","ownsCanvas","newCanvas","createCanvasElement","getCanvasContext","attributes","pixelated","imageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","webkitImageSmoothingEnabled","msImageSmoothingEnabled","SketchManager","_settings","_props","_sketch","_raf","_lastRedrawResult","_isP5Resizing","_keyboardShortcuts","handler","enabled","keyCode","altKey","metaKey","ctrlKey","togglePlay","preventDefault","commit","save","addEventListener","removeEventListener","keyboardShortcuts","this","hotkeys","shiftKey","recording","endRecord","play","record","exportFrame","playing","pause","_animateHandler","animate","_resizeHandler","resize","render","sketch","_computePlayhead","currentTime","duration","_computeFrame","playhead","time","fps","_computeCurrentFrame","_getSizeProps","run","dispose","warn","started","_signalBegin","tick","cancelAnimationFrame","_lastTime","rightNow","requestAnimationFrame","error","stop","deltaTime","frameInterval","log","_signalEnd","begin","_wrapContextScale","end","all","preExport","exportOpts","sequence","encoding","encodingQuality","dateformat","p","commitOpts","isPromise","_doExportFrame","drawResult","concat","hasDataObject","data","isDOM","includes","toDataURL","exportCanvas","layerList","curOpt","parts","saveFile","eventWithOutput","find","outputName","isClient","some","ofSeq","postExport","cb","_preRender","_postRender","p5","scale","scaleX","scaleY","scaleContext","restore","flush","redraw","submitDrawCall","update","notYetSupported","oldCanvas","oldContext","timeOpts","timeProps","getTimeProps","_setupGLKey","_appendCanvasIfNeeded","draw","oldSizes","newProps","pixelDensity","styleCanvas","newSizes","changed","_sizeChanged","frameIntervalMS","deltaTimeMS","hasDuration","isNewFrame","playbackRate","newTime","timeScale","isFinished","isLoopStart","loop","lastFrame","dispatch","mount","unmount","detach","parentElement","ctx","clear","clearColor","bufferData","hasTotalFrames","totalFramesFromDuration","durationFromTotalFrames","Infinity","startTime","startFrame","hasStartTime","hasStartFrame","setup","overrides","loadAndRun","canvasSketch","newSettings","load","unload","destroy","createSketch","preload","P5Constructor","p5Sketch","isGL","renderer","WEBGL","P2D","noLoop","setAttributes","_renderer","drawingContext","loader","attach","catch","message","runtimeCache","CACHE","isHot","hot","id","process","env","SKETCH_ENTRY","isInjecting","previousData","cacheGet","next","manager","cachePut","PaperSizes"],"mappings":"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"}